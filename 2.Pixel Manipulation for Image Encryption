from PIL import Image

def encrypt_image(input_path, output_path, key):
    """Encrypt an image by modifying its pixel values."""
    try:
        image = Image.open(input_path)
        encrypted_image = Image.new(image.mode, image.size)
        pixels = image.load()
        encrypted_pixels = encrypted_image.load()

        for x in range(image.width):
            for y in range(image.height):
                r, g, b = pixels[x, y]
                encrypted_pixels[x, y] = (
                    (r + key) % 256,
                    (g + key) % 256,
                    (b + key) % 256
                )

        encrypted_image.save(output_path)
        print(f"Image encrypted successfully and saved as {output_path}")
    except Exception as e:
        print(f"An error occurred: {e}")

def decrypt_image(input_path, output_path, key):
    """Decrypt an image by reversing the modification on its pixel values."""
    try:
        image = Image.open(input_path)
        decrypted_image = Image.new(image.mode, image.size)
        pixels = image.load()
        decrypted_pixels = decrypted_image.load()

        for x in range(image.width):
            for y in range(image.height):
                r, g, b = pixels[x, y]
                decrypted_pixels[x, y] = (
                    (r - key) % 256,
                    (g - key) % 256,
                    (b - key) % 256
                )

        decrypted_image.save(output_path)
        print(f"Image decrypted successfully and saved as {output_path}")
    except Exception as e:
        print(f"An error occurred: {e}")

def main():
    print("Image Encryption Tool")
    while True:
        print("\nOptions:")
        print("1. Encrypt an image")
        print("2. Decrypt an image")
        print("3. Exit")
        choice = input("Choose an option (1/2/3): ").strip()

        if choice == "1":
            input_path = input("Enter the path of the image to encrypt: ").strip()
            output_path = input("Enter the output path for the encrypted image: ").strip()
            key = int(input("Enter the encryption key (integer): ").strip())
            encrypt_image(input_path, output_path, key)

        elif choice == "2":
            input_path = input("Enter the path of the image to decrypt: ").strip()
            output_path = input("Enter the output path for the decrypted image: ").strip()
            key = int(input("Enter the decryption key (integer): ").strip())
            decrypt_image(input_path, output_path, key)

        elif choice == "3":
            print("Exiting the program. Goodbye!")
            break

        else:
            print("Invalid choice. Please try again.")

if __name__ == "__main__":
    main()
